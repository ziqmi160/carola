{% extends "base.html" %}

{% block title %}Home - Carola Car Rental{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="hero-content">
        <h1>Find Your Perfect Ride</h1>
        <p>Explore our wide selection of cars for rent across Malaysia</p>
        <a href="{{ url_for('cars') }}" class="btn btn-primary btn-large">Browse Cars</a>
    </div>
</div>

<div class="features-section">
    <div class="container">
        <h2 class="section-title">Why Choose Carola?</h2>
        <div class="features-grid">
            <div class="feature-card">
                <i class="fas fa-shield-alt"></i>
                <h3>Safe & Reliable</h3>
                <p>All our vehicles are regularly maintained and insured</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-dollar-sign"></i>
                <h3>Best Prices</h3>
                <p>Competitive rates with no hidden charges</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-map-marker-alt"></i>
                <h3>Multiple Locations</h3>
                <p>Pick up and drop off at convenient locations</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-headset"></i>
                <h3>24/7 Support</h3>
                <p>Round-the-clock customer service assistance</p>
            </div>
        </div>
    </div>
</div>

<div class="popular-cars-section">
    <div class="container">
        <h2 class="section-title">Popular Cars</h2>
        <div id="popular-cars" class="cars-grid">
            <!-- Cars will be loaded here -->
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Load popular cars on page load
    fetch('/api/cars?limit=6')
        .then(res => res.json())
        .then(data => {
            if (data.success) {
                const container = document.getElementById('popular-cars');
                const cars = data.cars.slice(0, 6);
                
                if (cars.length === 0) {
                    container.innerHTML = '<p class="no-results">No cars available at the moment.</p>';
                    return;
                }
                
                container.innerHTML = cars.map(car => `
                    <div class="car-card">
                        <div class="car-image">
                            <img src="${car.ATTACHMENTS ? '/uploads/' + car.ATTACHMENTS : 'https://via.placeholder.com/300x200?text=' + encodeURIComponent(car.BRAND_NAME + ' ' + car.MODEL_NAME)}" 
                                 alt="${car.BRAND_NAME} ${car.MODEL_NAME}" 
                                 onerror="this.src='https://via.placeholder.com/300x200?text=Car+Image'">
                        </div>
                        <div class="car-info">
                            <h3>${car.BRAND_NAME} ${car.MODEL_NAME}</h3>
                            <p class="car-type">${car.CARTYPE_NAME} â€¢ ${car.FUEL_TYPE || 'N/A'}</p>
                            <div class="car-details">
                                <span><i class="fas fa-users"></i> ${car.SEAT} Seats</span>
                                <span><i class="fas fa-suitcase"></i> ${car.SUITCASE} Bags</span>
                                <span><i class="fas fa-palette"></i> ${car.COLOUR}</span>
                            </div>
                            <div class="car-footer">
                                <span class="car-price">RM ${parseFloat(car.RATE).toFixed(2)}/day</span>
                                <a href="/book/${car.CAR_ID}" class="btn btn-primary">Book Now</a>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        })
        .catch(err => {
            console.error('Error loading cars:', err);
            document.getElementById('popular-cars').innerHTML = '<p class="error">Failed to load cars. Please try again later.</p>';
        });
</script>
{% endblock %}

